#
# The following constraints are limitations of the hardware architecture and dataflow
#

architecture_constraints:
  targets:
  # certain buffer only stores certain datatypes
  - target: psum_spad
    type: bypass
    bypass: [Inputs, Twiddles]
    keep: [Outputs]
  - target: weights_spad
    type: bypass
    bypass: [Inputs, Outputs]
    keep: [Twiddles]
  - target: ifmap_spad
    type: bypass
    bypass: [Twiddles, Outputs]
    keep: [Inputs]
  - target: DummyBuffer
    type: bypass
    bypass: [Inputs, Outputs, Twiddles]
  - target: shared_glb
    type: bypass
    bypass: [Twiddles]
    keep: [Inputs, Outputs]
  - target: DummyBuffer
    type: spatial
    permutation: KJSHTCN
  # only allow fanout of M, Q out from glb
  - target: shared_glb
    type: spatial
    permutation: KJSHTCN
  # one ofmap position but of different output channels
  - target: psum_spad
    type: temporal
    permutation: KJSHTCN
  # row stationary -> 1 row at a time
  - target: weights_spad
    type: temporal
    permutation: KJSHTCN
  - target: ifmap_spad
    type: temporal
    permutation: KJSHTCN
  # enforce the hardware limit of the bypassing everything
  - target: DummyBuffer
    type: temporal
